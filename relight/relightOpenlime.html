<!DOCTYPE html>
<html>

<head>
    <title>OpenLime</title>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8" />
	<link rel="stylesheet" href="css/skin.css"/>

	<style>
html, body {
	margin: 0px;
	padding: 0px;
	height: calc(100% - 80px);
}

#openlime {
	position:absolute;
	height: calc(100% - 90px);
}

#openlime>canvas {
	width: 100%;
	height: 100%;
	/* this is important, it would cause firefox flickering! */
	overflow: hidden;
}

	</style>
</head>

<body>
	<div id="openlime"></div>
</body>

<script src="js/openlime.min.js"></script>


<script>

//autodetect type:
async function autodetect() {
	response = await fetch('rti-folder/plane_0.dzi');
	if(response.status == 200)
		return "deepzoom";

	alert("Could not detect an RTI here");
	return "";
}

async function autodetectNormals(layout) {
	
	if(layout == 'deepzoom') {
		let response = await fetch('normals.dzi');
		if(response.status == 200)
			return true;
	}
	return false;
}


async function init() {
	let layout = await autodetect();
	let normals = await autodetectNormals(layout);
	var lime = new OpenLIME.Viewer('#openlime', { background:'grey' });


	let layer = new OpenLIME.Layer({ 
		layout: layout, 
		type:'rti',
		url: 'rti-folder/info.json',
		normals: normals
	});

	lime.canvas.addLayer('RTI', layer); 
	OpenLIME.Skin.setUrl('css/skin.svg');
	let ui = new OpenLIME.UIBasic(lime, { skin: 'skin.svg', showLightDirections: true });
	ui.actions.light.active = true;
	ui.actions.layers.display = true;
	lime.camera.maxFixedZoom = 1;
	window.lime = lime;
}

init();


</script>

</html>
